{% extends 'dashboard/dashboard.html' %}
{% block title %}Groups List{% endblock title %} 
{% block content %}

{% comment %} Show messages {% endcomment %}
{% if messages %}
<div class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4">
  {% for message in messages %}
  <div class="text-red-500 text-sm mb-2">
    {{ message }}
  </div>
  {% endfor %}
</div>
{% endif %}

{% comment %} Show errors {% endcomment %}
{% if form.errors %}
<div class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4">
  <ul class="text-red-500 text-sm">
    {% for field, errors in form.errors.items %}
    <li>{{ field }}: {{ errors|join:", " }}</li>
    {% endfor %}
  </ul>
</div>
{% endif %}
{% comment %} Show success messages {% endcomment %}
{% if request.GET.success %}
<div class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4">
  <div class="text-green-500 text-sm">
    {{ request.GET.success }}
  </div>
</div>
{% endif %}

<div class="flex justify-between px-5 py-3 border-b border-gray-200 bg-gray-100">
  <h1 class="text-lg font-semibold text-gray-700">Groups List</h1>
  <a
    href="{% url 'create-group' %}"
    class="inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"
  >
    Add Group
  </a>

</div>
<table class="w-full mx-auto" border="1" cellspacing="0" cellpadding="0">
  <thead>
    <tr>
      <th
        class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"
      >
        SL
      </th>
      <th
        class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"
      >
        Group Name
      </th>
      <th
        class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"
      >
        Permissions
      </th>
      <th
        class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"
      >
        Action
      </th>
    </tr>
  </thead>
  <tbody>
    {% comment %} Body Starts {% endcomment %} {% for group in groups %}
    <tr>
      <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">
        {{forloop.counter}}
      </td>
      <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">
        <div class="flex items-center">
          <div class="ml-3">
            <p class="text-gray-900 whitespace-no-wrap">{{group.name}}</p>
          </div>
        </div>
      </td>
      <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">
        <p class="text-gray-900 whitespace-no-wrap">
          {% for permission in group.permissions.all %}
          <span
            class="relative inline-block px-3 py-1 font-semibold text-green-900 leading-tight"
          >
            <span
              aria-hidden
              class="absolute inset-0 opacity-50 rounded-full"
            ></span>
            <span class="relative">{{permission.name}}</span> </span
          ><br />
          {% empty %}
          <span
            class="relative inline-block px-3 py-1 font-semibold text-red-900 leading-tight"
          >
            <span
              aria-hidden
              class="absolute inset-0 bg-red-200 opacity-50 rounded-full"
            ></span>
            <span class="relative">No permission assigned</span>
          </span>
          {% endfor %}
        </p>
      </td>
      <td class="px-2 py-1 border-2 border-gray-200">
        <a href="{% url 'delete-group' group.id %}" class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600">
        Delete
        </a>
      </td>
    </tr>
    {% endfor %} {% comment %} Body ends {% endcomment %}
  </tbody>
</table>
{% endblock content %}
